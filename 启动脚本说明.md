# 启动脚本说明

## 📋 可用的启动脚本

项目提供了多个启动脚本，方便在不同环境下快速启动应用。

### 🎯 推荐使用

#### 1. 同时启动前后端（最方便）

**Windows CMD:**
```bash
start_dev.bat
```

**PowerShell:**
```bash
.\start_dev.ps1
```

**功能：**
- ✅ 自动启动后端服务（新窗口）
- ✅ 自动启动前端服务（新窗口）
- ✅ 等待 3 秒确保后端先启动
- ✅ 显示访问地址
- ✅ 按任意键可同时停止所有服务

**适用场景：** 日常开发，快速启动整个应用

---

#### 2. 单独启动后端

**Windows CMD:**
```bash
启动后端.bat
```

**PowerShell:**
```bash
.\启动后端.ps1
```

**功能：**
- ✅ 检查是否在正确目录
- ✅ 自动激活虚拟环境（如果存在）
- ✅ 使用 `python -m uvicorn` 启动（避免模块路径问题）
- ✅ 启用热重载（--reload）
- ✅ 显示访问地址和 API 文档地址

**适用场景：** 
- 只需要后端服务
- 前端已经在运行
- 调试后端代码

---

#### 3. 单独启动前端

**Windows CMD:**
```bash
启动前端.bat
```

**PowerShell:**
```bash
.\启动前端.ps1
```

**功能：**
- ✅ 自动切换到 frontend 目录
- ✅ 启动 Vite 开发服务器
- ✅ 显示访问地址

**适用场景：**
- 只需要前端服务
- 后端已经在运行
- 调试前端代码

---

## 🔍 脚本对比

| 脚本 | 启动内容 | 窗口数 | 热重载 | 推荐场景 |
|------|---------|--------|--------|---------|
| `start_dev.bat/ps1` | 前端 + 后端 | 2 | ✅ | 日常开发 |
| `启动后端.bat/ps1` | 仅后端 | 1 | ✅ | 后端开发 |
| `启动前端.bat/ps1` | 仅前端 | 1 | ✅ | 前端开发 |

## 💡 使用建议

### 日常开发

**推荐使用：** `start_dev.bat` 或 `start_dev.ps1`

```bash
# 一键启动
start_dev.bat

# 会自动打开两个窗口：
# 窗口 1: 后端服务 (http://localhost:8000)
# 窗口 2: 前端服务 (http://localhost:5173)
```

### 前端开发

如果只修改前端代码，可以单独启动前端：

```bash
# 终端 1: 启动后端（保持运行）
启动后端.bat

# 终端 2: 启动前端（可以随时重启）
启动前端.bat
```

### 后端开发

如果只修改后端代码，可以单独启动后端：

```bash
# 终端 1: 启动后端（可以随时重启）
启动后端.bat

# 终端 2: 启动前端（保持运行）
启动前端.bat
```

## 🛠️ 脚本功能详解

### start_dev.bat/ps1（同时启动）

**特点：**
- 在新窗口中启动服务
- 自动等待后端启动完成
- 显示所有访问地址
- 可以一键停止所有服务

**启动顺序：**
1. 启动后端服务（新窗口）
2. 等待 3 秒
3. 启动前端服务（新窗口）
4. 显示访问地址

**停止方式：**
- CMD 版本：按任意键停止所有服务
- PowerShell 版本：关闭窗口或按 Ctrl+C

### 启动后端.bat/ps1

**特点：**
- 检查目录是否正确
- 自动激活虚拟环境
- 使用 `python -m uvicorn`（避免模块路径问题）
- 启用热重载

**检查项：**
1. 检查 `app/main.py` 是否存在
2. 检查虚拟环境是否存在
3. 显示当前目录

**启动命令：**
```bash
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

### 启动前端.bat/ps1

**特点：**
- 自动切换到 frontend 目录
- 启动 Vite 开发服务器
- 支持热重载

**启动命令：**
```bash
cd frontend
npm run dev
```

## ❓ 常见问题

### Q1: 为什么有 .bat 和 .ps1 两个版本？

**A:** 
- `.bat` - 适用于 Windows CMD（命令提示符）
- `.ps1` - 适用于 PowerShell

两者功能相同，选择你习惯的即可。

### Q2: 双击脚本没反应？

**A:** 
- `.bat` 文件可以直接双击运行
- `.ps1` 文件可能需要在 PowerShell 中运行：
  ```powershell
  .\启动后端.ps1
  ```
- 如果提示权限问题，运行：
  ```powershell
  Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
  ```

### Q3: 启动失败怎么办？

**A:** 
1. 检查是否在项目根目录
2. 运行诊断脚本：`python 诊断环境.py`
3. 查看详细错误信息
4. 参考 [docs/后端启动问题排查.md](docs/后端启动问题排查.md)

### Q4: 如何停止服务？

**A:**
- **start_dev.bat**: 按任意键停止所有服务
- **其他脚本**: 按 `Ctrl+C` 或关闭窗口

### Q5: 可以修改端口吗？

**A:** 可以，编辑脚本文件：

**后端端口（默认 8000）：**
```bash
# 修改这一行
python -m uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload
```

**前端端口（默认 5173）：**
```bash
# 在 frontend/vite.config.ts 中修改
server: {
  port: 5174
}
```

## 🎯 最佳实践

### 开发流程

1. **首次启动**
   ```bash
   # 安装依赖
   pip install -r requirements.txt
   cd frontend && npm install && cd ..
   
   # 配置环境变量
   copy .env.example .env
   # 编辑 .env 填入 API Key
   
   # 启动应用
   start_dev.bat
   ```

2. **日常开发**
   ```bash
   # 直接启动
   start_dev.bat
   
   # 或分别启动
   启动后端.bat  # 终端 1
   启动前端.bat  # 终端 2
   ```

3. **调试后端**
   ```bash
   # 只启动后端，方便查看日志
   启动后端.bat
   ```

4. **调试前端**
   ```bash
   # 后端保持运行，只重启前端
   启动前端.bat
   ```

### 推荐配置

**VS Code 用户：**

可以在 `.vscode/tasks.json` 中配置任务：

```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "启动后端",
      "type": "shell",
      "command": "${workspaceFolder}/启动后端.bat",
      "problemMatcher": []
    },
    {
      "label": "启动前端",
      "type": "shell",
      "command": "${workspaceFolder}/启动前端.bat",
      "problemMatcher": []
    }
  ]
}
```

## 📚 相关文档

- [README.md](README.md) - 项目主文档
- [docs/后端启动问题排查.md](docs/后端启动问题排查.md) - 启动问题详细排查
- [诊断环境.py](诊断环境.py) - 环境诊断工具

## 🎉 总结

项目提供了 6 个启动脚本，涵盖不同的使用场景：

- ✅ **日常开发** - 使用 `start_dev.bat/ps1` 一键启动
- ✅ **后端开发** - 使用 `启动后端.bat/ps1` 单独启动后端
- ✅ **前端开发** - 使用 `启动前端.bat/ps1` 单独启动前端

所有脚本都经过优化，包含错误检查和友好提示，让启动应用变得简单快捷！

---

**更新时间：** 2024-01-17
**状态：** ✅ 已整理
